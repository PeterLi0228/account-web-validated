# ç®€è®°è´¦ Â· ç»¼åˆäº§å“æŠ€æœ¯æ–‡æ¡£ï¼ˆæ›´æ–°ç‰ˆï¼‰

---

## ğŸ“ ä¸€ã€æ•°æ®åº“ç»“æ„è®¾è®¡ï¼ˆæ‰§è¡Œé¡ºåºå·²ä¿®æ­£ï¼‰

### 1. bills è´¦æœ¬è¡¨

```sql
CREATE TABLE public.bills (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  owner_id uuid,
  name text NOT NULL,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT bills_pkey PRIMARY KEY (id),
  CONSTRAINT bills_owner_id_fkey FOREIGN KEY (owner_id) REFERENCES auth.users(id)
);
```

### 2. bill_members æˆå‘˜æƒé™è¡¨

```sql
CREATE TABLE public.bill_members (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  bill_id uuid,
  user_id uuid,
  permission text CHECK (permission = ANY (ARRAY['edit_add', 'add_only', 'view_only'])),
  created_at timestamp without time zone DEFAULT now(),
  CONSTRAINT bill_members_pkey PRIMARY KEY (id),
  CONSTRAINT bill_members_bill_id_fkey FOREIGN KEY (bill_id) REFERENCES public.bills(id),
  CONSTRAINT bill_members_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
```

### 3. categories åˆ†ç±»è¡¨

```sql
CREATE TABLE public.categories (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  bill_id uuid NOT NULL,
  user_id uuid NOT NULL,
  name text NOT NULL,
  type text NOT NULL CHECK (type = ANY (ARRAY['income', 'expense'])),
  created_at timestamp without time zone DEFAULT now(),
  CONSTRAINT categories_pkey PRIMARY KEY (id),
  CONSTRAINT categories_bill_id_fkey FOREIGN KEY (bill_id) REFERENCES public.bills(id),
  CONSTRAINT categories_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
```

### 4. transactions äº¤æ˜“è®°å½•è¡¨ï¼ˆå¼•ç”¨åˆ†ç±»ï¼‰

```sql
CREATE TABLE public.transactions (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  bill_id uuid,
  user_id uuid,
  type text NOT NULL CHECK (type = ANY (ARRAY['income', 'expense'])),
  date date NOT NULL,
  item text NOT NULL,
  amount numeric NOT NULL,
  person text,
  note text,
  category_id uuid,
  created_at timestamp without time zone DEFAULT now(),
  CONSTRAINT transactions_pkey PRIMARY KEY (id),
  CONSTRAINT transactions_category_id_fkey FOREIGN KEY (category_id) REFERENCES public.categories(id),
  CONSTRAINT transactions_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id),
  CONSTRAINT transactions_bill_id_fkey FOREIGN KEY (bill_id) REFERENCES public.bills(id)
);
```

### 5. ai_logs èŠå¤©æ—¥å¿—è¡¨

```sql
CREATE TABLE public.ai_logs (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  bill_id uuid,
  user_id uuid,
  role text CHECK (role = ANY (ARRAY['user', 'assistant'])),
  content text,
  created_at timestamp without time zone DEFAULT now(),
  CONSTRAINT ai_logs_pkey PRIMARY KEY (id),
  CONSTRAINT ai_logs_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id),
  CONSTRAINT ai_logs_bill_id_fkey FOREIGN KEY (bill_id) REFERENCES public.bills(id)
);
```

---

## ğŸ” äºŒã€ç”¨æˆ·æ³¨å†Œä¸ç™»å½•è®¾è®¡

### âœ… æŠ€æœ¯æ–¹å¼

- ä½¿ç”¨ Supabase çš„ Email Provider ç™»å½•æœºåˆ¶
- è´¦å·å°†ä½œä¸ºä¼ªé€ é‚®ç®±ï¼ˆå¦‚ `zhangsan@like.com`ï¼‰å­˜å‚¨
- å…³é—­é‚®ç®±éªŒè¯åŠŸèƒ½ï¼ˆConfirm Emailï¼‰
- å‰ç«¯å°†ç”¨æˆ·åæ‹¼æ¥ä¸ºé‚®ç®±å­—æ®µä¼ å…¥ Supabase
- `Display Name` ä¼ å…¥ç”¨æˆ·çš„ç”¨æˆ·åï¼Œå¹¶ä¸”æ ¹æ® UIï¼Œå¯ä»¥æ›´æ”¹
  - ç¤ºä¾‹ï¼šç”¨æˆ·åä¸º `like`ï¼Œåˆ™é‚®ç®±ä¸º `like@like.com`ï¼ŒDisplay Name ä¸º `like`

---

## ğŸ“Œ ä¸‰ã€æ³¨æ„äº‹é¡¹

- ç”¨æˆ·åå¿…é¡»å”¯ä¸€ï¼ˆå»ºè®®å‰ç«¯é™åˆ¶ï¼‰
- æ‰€æœ‰ fake email å¿…é¡»éµå¾ªç»Ÿä¸€è§„åˆ™ï¼ˆå¦‚ï¼š`@like.com`ï¼‰
- ç™»å½•è¡Œä¸ºåªèƒ½ä½¿ç”¨ç”¨æˆ·åç™»å½•ï¼Œä¸èƒ½ç”¨é‚®ç®±

---

## ğŸ§­ å››ã€å‰ç«¯äº¤äº’é€»è¾‘è¯´æ˜

### 1. ç”¨æˆ·æ³¨å†Œå¼•å¯¼

- ç”¨æˆ·æ³¨å†Œå®Œæˆåï¼Œç³»ç»Ÿåº”è‡ªåŠ¨è·³è½¬åˆ°â€œåˆ›å»ºè´¦æœ¬â€é¡µé¢
- æ­¤é¡µé¢ä¸ºç”¨æˆ·é¦–æ¬¡å¼ºåˆ¶å…¥å£ï¼Œæœªåˆ›å»ºè´¦æœ¬å‰æ— æ³•ç»§ç»­ä½¿ç”¨äº§å“åŠŸèƒ½

### 2. UI å®ç°çº¦å®š

- æ‰€æœ‰å‰ç«¯åŠŸèƒ½é€»è¾‘å¿…é¡» **ä¸¥æ ¼éµå¾ªè®¾è®¡ UI**
- ä¸å¾—ä¿®æ”¹ç»„ä»¶æ ·å¼ã€å¸ƒå±€ã€äº¤äº’ç»†èŠ‚ï¼ŒåªåšåŠŸèƒ½ç»‘å®š
- å®ç°ä»¥â€œç¬¦åˆè®¾è®¡ç¨¿â€ä¸ºæœ€é«˜ä¼˜å…ˆ

## äº”ã€Router API å®ç°èŒƒä¾‹

fetch("https://openrouter.ai/api/v1/chat/completions", {
  method: "POST",
  headers: {
    "Authorization": "Bearer <OPENROUTER_API_KEY>",
    "HTTP-Referer": "<YOUR_SITE_URL>", // Optional. Site URL for rankings on openrouter.ai.
    "X-Title": "<YOUR_SITE_NAME>", // Optional. Site title for rankings on openrouter.ai.
    "Content-Type": "application/json"
  },
  body: JSON.stringify({
    "model": "deepseek/deepseek-chat-v3-0324:free",
    "messages": [
      {
        "role": "user",
        "content": "What is the meaning of life?"
      }
    ]
  })
});